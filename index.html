<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Príbehy Generátor</title>
    <!-- Tailwind CSS CDN for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for Inter font and general body styling */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Removed modal styles as they are no longer needed */
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-gray-900 to-gray-800 flex items-center justify-center p-4">

    <div class="bg-gray-800 p-8 rounded-xl shadow-2xl w-full max-w-2xl border border-gray-700">
        <h1 class="text-4xl font-extrabold text-white mb-8 text-center tracking-wide">
            AI Príbehy Generátor
        </h1>

        <!-- Sekcia ovládacích prvkov -->
        <div class="flex flex-col sm:flex-row items-center justify-center gap-4 mb-8">
            <select
                id="storyType"
                class="p-3 rounded-lg bg-gray-700 text-white border border-gray-600 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-200 w-full sm:w-auto"
            >
                <option value="scary">Strašidelný príbeh</option>
                <option value="fantasy">Fantasy príbeh</option>
                <option value="sci-fi">Sci-Fi príbeh</option>
                <option value="mystery">Mysteriózny príbeh</option>
                <option value="horror">Hororový príbeh</option>
                <option value="romantic">Romantický príbeh</option>
                <option value="comedy">Komediálny príbeh</option>
                <option value="thriller">Thriller</option>
                <option value="adventure">Dobrodružný príbeh</option>
                <option value="historical">Historický príbeh</option>
                <option value="children">Príbeh pre deti</option>
                <option value="fairytale">Rozprávka</option>
                <option value="dystopian">Dystopický príbeh</option>
                <option value="utopian">Utopický príbeh</option>
                <option value="cyberpunk">Cyberpunk príbeh</option>
                <option value="steampunk">Steampunk príbeh</option>
                <option value="post-apocalyptic">Post-apokalyptický príbeh</option>
                <option value="western">Western</option>
                <option value="noir">Noir detektívka</option>
                <option value="magical-realism">Magický realizmus</option>
                <option value="slice-of-life">Každodenný život (Slice of Life)</option>
                <option value="bildungsroman">Bildungsroman (príbeh dospievania)</option>
                <option value="mythological">Mytologický príbeh</option>
                <option value="urban-fantasy">Mestská fantasy</option>
                <option value="superhero">Superhrdinský príbeh</option>
                <option value="space-opera">Vesmírna opera</option>
                <option value="military-sci-fi">Vojenská sci-fi</option>
                <option value="biographical">Biografický príbeh</option>
                <option value="philosophical">Filozofický príbeh</option>
                <option value="satire">Satirický príbeh</option>
                <option value="parody">Paródia</option>
                <option value="fable">Bájka</option>
                <option value="legend">Legenda</option>
                <option value="epic">Epický príbeh</option>
                <option value="tragedy">Tragédia</option>
                <option value="drama">Dráma</option>
                <option value="coming-of-age">Príbeh o dospievaní</option>
                <option value="survival">Príbeh o prežití</option>
                <option value="sports">Športový príbeh</option>
                <option value="musical">Muzikál</option>
                <option value="political-thriller">Politický thriller</option>
                <option value="legal-drama">Právna dráma</option>
                <option value="medical-drama">Lekárska dráma</option>
                <option value="heist">Príbeh o lúpeži</option>
                <option value="spy">Špionážny príbeh</option>
                <option value="conspiracy">Konšpiračný príbeh</option>
                <option value="psychological-thriller">Psychologický thriller</option>
                <option value="gothic">Gotický príbeh</option>
                <option value="creepy-pasta">Creepypasta</option>
                <option value="found-footage">Found Footage (príbeh)</option>
                <option value="body-horror">Body Horor</option>
                <option value="cosmic-horror">Kozmický horor</option>
                <option value="folk-horror">Folklórny horor</option>
                <option value="splatterpunk">Splatterpunk</option>
                <option value="ghost-story">Príbeh o duchoch</option>
                <option value="vampire">Upírsky príbeh</option>
                <option value="werewolf">Vlkolacký príbeh</option>
                <option value="zombie">Zombie príbeh</option>
                <option value="kaiju">Kaiju príbeh</option>
                <option value="mecha">Mecha príbeh</option>
                <option value="time-travel">Cestovanie časom</option>
                <option value="alternate-history">Alternatívna história</option>
                <option value="stealth-punk">Stealth-punk</option>
                <option value="biopunk">Biopunk</option>
                <option value="nanopunk">Nanopunk</option>
                <option value="solarpunk">Solarpunk</option>
                <option value="cli-fi">Cli-fi (Klimatická fikcia)</option>
                <option value="speculative-fiction">Špekulatívna fikcia</option>
                <option value="lit-fic">Literárna fikcia</option>
                <option value="young-adult">Young Adult (YA)</option>
                <option value="new-adult">New Adult (NA)</option>
                <option value="middle-grade">Middle Grade</option>
                <option value="picture-book">Obrázková kniha</option>
                <option value="graphic-novel">Grafický román</option>
                <option value="short-story">Krátky príbeh</option>
                <option value="flash-fiction">Flash Fiction</option>
                <option value="poetry">Poézia (príbehová)</option>
                <option value="epistolary">Epistolárny príbeh</option>
                <option value="journal-entry">Zápisky z denníka</option>
                <option value="found-document">Nájdený dokument</option>
                <option value="interactive">Interaktívny príbeh</option>
                <option value="metafiction">Metafikcia</option>
                <option value="absurdist">Absurdistický príbeh</option>
                <option value="surreal">Surrealistický príbeh</option>
                <option value="experimental">Experimentálny príbeh</option>
                <option value="stream-of-consciousness">Prúd vedomia</option>
                <option value="gothic-romance">Gotická romanca</option>
                <option value="paranormal-romance">Paranormálna romanca</option>
                <option value="historical-romance">Historická romanca</option>
                <option value="contemporary-romance">Súčasná romanca</option>
                <option value="erotic-romance">Erotická romanca</option>
                <option value="romantic-comedy">Romantická komédia</option>
                <option value="dark-comedy">Čierna komédia</option>
                <option value="farce">Fraška</option>
                <option value="slapstick">Slapstick komédia</option>
                <option value="action-comedy">Akčná komédia</option>
                <option value="buddy-comedy">Buddy komédia</option>
                <option value="coming-of-age-comedy">Komédia o dospievaní</option>
                <option value="mockumentary">Mockumentary (príbeh)</option>
                <option value="true-crime">Skutočný zločin (fikcia)</option>
                <option value="procedural">Procedurálny príbeh</option>
                <option value="hard-boiled">Hard-boiled detektívka</option>
                <option value="cozy-mystery">Útulná záhada</option>
                <option value="espionage">Špionáž</option>
                <option value="conspiracy-thriller">Konšpiračný thriller</option>
                <option value="techno-thriller">Techno-thriller</option>
                <option value="eco-thriller">Eko-thriller</option>
                <option value="disaster">Katastrofický príbeh</option>
                <option value="prison-break">Útek z väzenia</option>
                <option value="revenge">Príbeh o pomste</option>
                <option value="quest">Príbeh o výprave</option>
                <option value="bildungsroman-fantasy">Fantasy Bildungsroman</option>
                <option value="bildungsroman-sci-fi">Sci-Fi Bildungsroman</option>
            </select>
            <button
                id="generateStoryBtn"
                class="px-6 py-3 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-800 transition duration-200 ease-in-out transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed w-full sm:w-auto"
            >
                Generovať príbeh
            </button>
        </div>

        <!-- Sekcia výstupu príbehu -->
        <div class="relative bg-gray-700 p-6 rounded-lg min-h-[200px] flex items-center justify-center border border-gray-600 mb-8">
            <!-- Správa o načítavaní príbehu -->
            <p id="loadingStoryMessage" class="hidden text-gray-400 text-lg animate-pulse">Generujem príbeh...</p>
            
            <!-- Správa o chybe pri čítaní reči -->
            <p id="speechErrorMessage" class="hidden absolute top-4 left-1/2 -translate-x-1/2 text-red-400 text-md"></p>

            <!-- Správa o pripájaní AI pre čítanie -->
            <p id="connectingAIMessage" class="hidden absolute top-4 left-1/2 -translate-x-1/2 text-blue-400 text-md animate-pulse">Pripájam AI...</p>

            <!-- Obsah príbehu -->
            <div
                id="storyContent"
                class="hidden text-gray-200 text-lg leading-relaxed cursor-pointer hover:text-blue-300 transition duration-200 text-left"
                style="white-space: pre-wrap;"
            >
                <!-- Tu sa zobrazí vygenerovaný príbeh -->
            </div>

            <!-- Počiatočná správa -->
            <p id="initialMessage" class="text-gray-500 text-lg italic">
                Vyber typ príbehu a klikni na "Generovať príbeh".
            </p>
        </div>

        <!-- Správa o stave generovania (pôvodne limitMessageContainer) -->
        <div id="statusMessageContainer" class="text-center text-sm px-4">
            <p id="statusMessage" class="text-gray-400 mb-4">Generovanie príbehov je úplne zadarmo!</p>
            <!-- Premium options and payment info removed -->
        </div>
    </div>

    <!-- Payment Simulation Modal removed -->

    <script>
        // DOM elementy
        const storyTypeSelect = document.getElementById('storyType');
        const generateStoryBtn = document.getElementById('generateStoryBtn');
        const loadingStoryMessage = document.getElementById('loadingStoryMessage');
        const speechErrorMessage = document.getElementById('speechErrorMessage');
        const connectingAIMessage = document.getElementById('connectingAIMessage');
        const storyContentDiv = document.getElementById('storyContent');
        const initialMessage = document.getElementById('initialMessage');
        const statusMessage = document.getElementById('statusMessage'); // Updated ID from limitMessage

        // Globálna premenná pre aktuálny príbeh
        let currentStory = '';
        // Referencia na SpeechSynthesisUtterance, aby sme mohli zastaviť čítanie
        let currentUtterance = null;

        // Funkcia na zobrazenie/skrytie elementov
        function showElement(element) {
            element.classList.remove('hidden');
        }

        function hideElement(element) {
            element.classList.add('hidden');
        }

        // Simplified checkGenerationLimit function
        function checkGenerationLimit() {
            // All generation is free, so just ensure the button is enabled
            generateStoryBtn.disabled = false;
            statusMessage.textContent = 'Generovanie príbehov je úplne zadarmo!';
        }

        // Funkcia na generovanie príbehu pomocou Gemini API
        async function generateStory() {
            showElement(loadingStoryMessage);
            hideElement(storyContentDiv);
            hideElement(initialMessage);
            hideElement(speechErrorMessage);
            currentStory = '';

            if (currentUtterance && window.speechSynthesis.speaking) {
                window.speechSynthesis.cancel();
                hideElement(connectingAIMessage);
            }

            let promptText = '';
            switch (storyTypeSelect.value) {
                case 'scary':
                    promptText = "Napíš krátky, strašidelný príbeh, ktorý sa odohráva v opustenom dome.";
                    break;
                case 'fantasy':
                    promptText = "Napíš krátky fantasy príbeh o mladom čarodejníkovi, ktorý objaví skrytý portál.";
                    break;
                case 'sci-fi':
                    promptText = "Napíš krátky sci-fi príbeh o posádke vesmírnej lode, ktorá narazí na neznámy signál.";
                    break;
                case 'mystery':
                    promptText = "Napíš krátky detektívny príbeh, kde je potrebné vyriešiť záhadu zmiznutého predmetu.";
                    break;
                case 'horror':
                    promptText = "Napíš extrémne desivý hororový príbeh, ktorý vyvolá zimomriavky a pocit úzkosti. Zameraj sa na psychologický teror a pomaly budovanú atmosféru strachu.";
                    break;
                case 'romantic':
                    promptText = "Napíš krátky romantický príbeh o dvoch ľuďoch, ktorí sa stretnú za nečakaných okolností a nájdu lásku.";
                    break;
                case 'comedy':
                    promptText = "Napíš krátky a vtipný komediálny príbeh o sérii nešťastných udalostí, ktoré vedú k absurdnému záveru.";
                    break;
                case 'thriller':
                    promptText = "Napíš napínavý thriller o prenasledovaní a úniku, kde je hlavný hrdina v nebezpečenstve a musí odhaliť sprisahanie.";
                    break;
                case 'adventure':
                    promptText = "Napíš dobrodružný príbeh o hľadaní strateného pokladu v neprebádanej džungli.";
                    break;
                case 'historical':
                    promptText = "Napíš krátky historický príbeh odohrávajúci sa v stredovekej Európe, zameraný na život obyčajného človeka.";
                    break;
                case 'children':
                    promptText = "Napíš krátky, poučný príbeh pre deti o malom zvieratku, ktoré sa učí dôležitú lekciu.";
                    break;
                case 'fairytale':
                    promptText = "Napíš klasickú rozprávku s princeznou/princeznou, kúzlami a šťastným koncom.";
                    break;
                case 'dystopian':
                    promptText = "Napíš krátky dystopický príbeh o živote v totalitnej spoločnosti, kde sa jednotlivec snaží o slobodu.";
                    break;
                case 'utopian':
                    promptText = "Napíš krátky utopický príbeh o dokonalej spoločnosti, kde vládne mier a harmónia.";
                    break;
                case 'cyberpunk':
                    promptText = "Napíš krátky cyberpunk príbeh odohrávajúci sa v futuristickom meste plnom kybernetických implantátov a korporátnych intríg.";
                    break;
                case 'steampunk':
                    promptText = "Napíš krátky steampunk príbeh s vynálezmi poháňanými parou a dobrodružstvom vo viktoriánskom štýle.";
                    break;
                case 'post-apocalyptic':
                    promptText = "Napíš krátky post-apokalyptický príbeh o prežití v zničenom svete po globálnej katastrofe.";
                    break;
                case 'western':
                    promptText = "Napíš krátky westernový príbeh o osamelom pištoľníkovi, ktorý prichádza do mesta plného problémov.";
                    break;
                case 'noir':
                    promptText = "Napíš krátku noir detektívku s cynickým súkromným očkom, femme fatale a temnými tajomstvami.";
                    break;
                case 'magical-realism':
                    promptText = "Napíš krátky príbeh magického realizmu, kde sa v obyčajnom svete objavia nečakané a nevysvetliteľné magické prvky.";
                    break;
                case 'slice-of-life':
                    promptText = "Napíš krátky príbeh z každodenného života, zameraný na malé radosti a starosti obyčajného človeka.";
                    break;
                case 'bildungsroman':
                    promptText = "Napíš krátky príbeh o dospievaní postavy, ktorá prechádza významnou zmenou a učí sa o sebe a svete.";
                    break;
                case 'mythological':
                    promptText = "Napíš krátky príbeh inšpirovaný starovekou mytológiou, s bohmi, hrdinami a epickými udalosťami.";
                    break;
                case 'urban-fantasy':
                    promptText = "Napíš krátky mestský fantasy príbeh, kde sa v modernom meste skrývajú magické bytosti a tajné spoločnosti.";
                    break;
                case 'superhero':
                    promptText = "Napíš krátky superhrdinský príbeh o hrdinovi s neobyčajnými schopnosťami, ktorý čelí novej hrozbe.";
                    break;
                case 'space-opera':
                    promptText = "Napíš rozsiahly vesmírny opera príbeh o medzigalaktickom konflikte a osude celého vesmíru.";
                    break;
                case 'military-sci-fi':
                    promptText = "Napíš krátky vojenský sci-fi príbeh o elitnej jednotke vojakov bojujúcich proti mimozemskej hrozbe.";
                    break;
                case 'biographical':
                    promptText = "Napíš krátky biografický príbeh o významnej historickej osobnosti a jej kľúčovom momente v živote.";
                    break;
                case 'philosophical':
                    promptText = "Napíš krátky filozofický príbeh, ktorý skúma hlboké otázky o existencii, morálke alebo zmysle života.";
                    break;
                case 'satire':
                    promptText = "Napíš krátky satirický príbeh, ktorý humorným spôsobom kritizuje spoločenské normy alebo politické udalosti.";
                    break;
                case 'parody':
                    promptText = "Napíš krátku paródiu na známy príbeh, film alebo žáner, s prehnanými a vtipnými prvkami.";
                    break;
                case 'fable':
                    promptText = "Napíš krátku bájku so zvieracími postavami a morálnym ponaučením na konci.";
                    break;
                case 'legend':
                    promptText = "Napíš krátku legendu o hrdinskom čine alebo pôvode nejakého miesta či javu.";
                    break;
                case 'epic':
                    promptText = "Napíš krátky epický príbeh o veľkom hrdinovi a jeho dlhej a náročnej ceste.";
                    break;
                case 'tragedy':
                    promptText = "Napíš krátku tragédiu o postave, ktorá sa stretáva s nevyhnutným osudom a pádom.";
                    break;
                case 'drama':
                    promptText = "Napíš krátku drámu zameranú na intenzívne medziľudské vzťahy a emocionálne konflikty.";
                    break;
                case 'coming-of-age':
                    promptText = "Napíš krátky príbeh o dospievaní, kde hlavná postava prechádza významnou životnou zmenou a objavuje svoju identitu.";
                    break;
                case 'survival':
                    promptText = "Napíš krátky príbeh o prežití v drsných podmienkach, kde hrdina musí použiť všetky svoje schopnosti, aby prežil.";
                    break;
                case 'sports':
                    promptText = "Napíš krátky športový príbeh o tíme alebo jednotlivcovi, ktorý prekonáva prekážky a dosahuje víťazstvo.";
                    break;
                case 'musical':
                    promptText = "Napíš krátky príbeh, ktorý by mohol byť základom pre muzikál, s prvkami hudby a tanca.";
                    break;
                case 'political-thriller':
                    promptText = "Napíš politický thriller o tajnom sprisahaní vo vláde a novinárovi, ktorý sa ho snaží odhaliť.";
                    break;
                case 'legal-drama':
                    promptText = "Napíš krátku právnu drámu o súdnom procese, kde sa bojuje za spravodlivosť.";
                    break;
                case 'medical-drama':
                    promptText = "Napíš krátku lekársku drámu odohrávajúcu sa v nemocnici, zameranú na životy lekárov a pacientov.";
                    break;
                case 'heist':
                    promptText = "Napíš krátky príbeh o dokonalej lúpeži, kde skupina zlodejov plánuje a vykonáva zložité prepadnutie.";
                    break;
                case 'spy':
                    promptText = "Napíš krátky špionážny príbeh o tajnom agentovi na nebezpečnej misii za nepriateľskými líniami.";
                    break;
                case 'conspiracy':
                    promptText = "Napíš krátky konšpiračný príbeh o tajnej organizácii, ktorá ovláda svet z pozadia.";
                    break;
                case 'psychological-thriller':
                    promptText = "Napíš psychologický thriller, ktorý sa hrá s mysľou čitateľa, plný zvratov a neistoty.";
                    break;
                case 'gothic':
                    promptText = "Napíš krátky gotický príbeh s temnou atmosférou, starým sídlom a prvkami romantiky a hrôzy.";
                    break;
                case 'creepy-pasta':
                    promptText = "Napíš krátku creepypastu, desivý internetový príbeh, ktorý má vyvolať strach a nepokoj.";
                    break;
                case 'found-footage':
                    promptText = "Napíš krátky príbeh vo formáte 'found footage', ako keby bol objavený záznam desivých udalostí.";
                    break;
                case 'body-horror':
                    promptText = "Napíš krátky body horor príbeh zameraný na deformácie, mutácie a fyzické znetvorenie tela.";
                    break;
                case 'cosmic-horror':
                    promptText = "Napíš krátky kozmický horor inšpirovaný H.P. Lovecraftom, kde ľudstvo čelí nepochopiteľným entitám z vesmíru.";
                    break;
                case 'folk-horror':
                    promptText = "Napíš krátky folklórny horor príbeh odohrávajúci sa vo vidieckom prostredí s prvkami starých rituálov a pohanských božstiev.";
                    break;
                case 'splatterpunk':
                    promptText = "Napíš krátky splatterpunk príbeh, ktorý je extrémne grafický a zameraný na násilie a telesné hrôzy.";
                    break;
                case 'ghost-story':
                    promptText = "Napíš klasický príbeh o duchoch s tajomným zjavením a nedoriešenou minulosťou.";
                    break;
                case 'vampire':
                    promptText = "Napíš krátky upírsky príbeh, ktorý skúma temnú romantiku a prekliatie nesmrteľnosti.";
                    break;
                case 'werewolf':
                    promptText = "Napíš krátky vlkolacký príbeh o premene a boji s vnútornou beštiou.";
                    break;
                case 'zombie':
                    promptText = "Napíš krátky zombie príbeh o prežití v meste zamorenom nemŕtvymi.";
                    break;
                case 'kaiju':
                    promptText = "Napíš krátky kaiju príbeh o obrovskom monštre, ktoré útočí na mesto.";
                    break;
                case 'mecha':
                    promptText = "Napíš krátky mecha príbeh o pilotovi obrovského robota, ktorý bráni ľudstvo pred hrozbou.";
                    break;
                case 'time-travel':
                    promptText = "Napíš krátky príbeh o cestovaní časom, kde zmena minulosti ovplyvní budúcnosť.";
                    break;
                case 'alternate-history':
                    promptText = "Napíš krátky príbeh alternatívnej histórie, kde sa kľúčová udalosť v minulosti vyvinula inak.";
                    break;
                case 'stealth-punk':
                    promptText = "Napíš krátky stealth-punk príbeh o svete, kde sú technológie skryté a používané na tajné operácie.";
                    break;
                case 'biopunk':
                    promptText = "Napíš krátky biopunk príbeh zameraný na genetické inžinierstvo a biologické modifikácie.";
                    break;
                case 'nanopunk':
                    promptText = "Napíš krátky nanopunk príbeh o svete ovládanom nanotechnológiami a ich dôsledkami.";
                    break;
                case 'solarpunk':
                    promptText = "Napíš krátky solarpunk príbeh o optimistickej, udržateľnej budúcnosti poháňanej obnoviteľnými zdrojmi.";
                    break;
                case 'cli-fi':
                    promptText = "Napíš krátky cli-fi príbeh, ktorý sa zaoberá dôsledkami klimatických zmien na ľudskú spoločnosť.";
                    break;
                case 'speculative-fiction':
                    promptText = "Napíš krátky špekulatívny fikčný príbeh, ktorý skúma 'čo keby' scenáre v blízkej budúcnosti alebo alternatívnej realite.";
                    break;
                case 'lit-fic':
                    promptText = "Napíš krátky literárny fikčný príbeh, ktorý sa zameriava na hlboké postavy, témy a štýl písania.";
                    break;
                case 'young-adult':
                    promptText = "Napíš krátky Young Adult príbeh o mladom hrdinovi, ktorý čelí výzvam dospievania v neobyčajnom svete.";
                    break;
                case 'new-adult':
                    promptText = "Napíš krátky New Adult príbeh o mladých dospelých, ktorí sa vyrovnávajú s láskou, kariérou a osobným rastom.";
                    break;
                case 'middle-grade':
                    promptText = "Napíš krátky príbeh pre Middle Grade čitateľov (8-12 rokov) o dobrodružstve a priateľstve.";
                    break;
                case 'picture-book':
                    promptText = "Napíš veľmi krátky príbeh vhodný pre obrázkovú knihu pre najmenších, s jednoduchým dejom a jasným posolstvom.";
                    break;
                case 'graphic-novel':
                    promptText = "Napíš krátky príbeh, ktorý by bol vhodný pre grafický román, s dôrazom na vizuálne rozprávanie.";
                    break;
                case 'short-story':
                    promptText = "Napíš jednoduchý krátky príbeh na ľubovoľnú tému.";
                    break;
                case 'flash-fiction':
                    promptText = "Napíš extrémne krátky príbeh (flash fiction), do 500 slov, s prekvapivým zvratom.";
                    break;
                case 'poetry':
                    promptText = "Napíš krátku príbehovú báseň, ktorá rozpráva o udalosti alebo emócii.";
                    break;
                case 'epistolary':
                    promptText = "Napíš krátky epistolárny príbeh, ktorý je rozprávaný prostredníctvom listov, emailov alebo denníkových zápiskov.";
                    break;
                case 'journal-entry':
                    promptText = "Napíš krátky príbeh vo forme denníkového zápisu, ktorý popisuje neobyčajnú udalosť.";
                    break;
                case 'found-document':
                    promptText = "Napíš krátky príbeh, ktorý je prezentovaný ako 'nájdený dokument' (napr. policajná správa, vedecká štúdia).";
                    break;
                case 'interactive':
                    promptText = "Napíš krátky interaktívny príbeh s možnosťami výberu, ktoré vedú k rôznym koncom.";
                    break;
                case 'metafiction':
                    promptText = "Napíš krátky metafikčný príbeh, ktorý si uvedomuje svoju vlastnú fikčnú povahu a hrá sa s ňou.";
                    break;
                case 'absurdist':
                    promptText = "Napíš krátky absurdný príbeh, ktorý sa vyznačuje nelogickými a nezmyselnými udalosťami.";
                    break;
                case 'surreal':
                    promptText = "Napíš krátky surrealistický príbeh, ktorý sa odohráva v snovom, iracionálnom svete.";
                    break;
                case 'experimental':
                    promptText = "Napíš krátky experimentálny príbeh, ktorý sa odchyľuje od tradičných naratívnych štruktúr.";
                    break;
                case 'stream-of-consciousness':
                    promptText = "Napíš krátky príbeh vo forme prúdu vedomia, ktorý zachytáva myšlienky a pocity postavy.";
                    break;
                case 'gothic-romance':
                    promptText = "Napíš krátku gotickú romancu s temným tajomstvom, strašidelným prostredím a vášnivou láskou.";
                    break;
                case 'paranormal-romance':
                    promptText = "Napíš krátku paranormálnu romancu o láske medzi človekom a nadprirodzenou bytosťou.";
                    break;
                case 'historical-romance':
                    promptText = "Napíš krátku historickú romancu odohrávajúcu sa v minulosti s romantickým príbehom.";
                    break;
                case 'contemporary-romance':
                    promptText = "Napíš krátku súčasnú romancu odohrávajúcu sa v dnešnej dobe, zameranú na moderné vzťahy.";
                    break;
                case 'erotic-romance':
                    promptText = "Napíš krátku erotickú romancu s dôrazom na zmyselnosť a intímne scény.";
                    break;
                case 'romantic-comedy':
                    promptText = "Napíš krátku romantickú komédiu s vtipnými situáciami a šťastným romantickým koncom.";
                    break;
                case 'dark-comedy':
                    promptText = "Napíš krátku čiernu komédiu, ktorá sa humorným spôsobom zaoberá temnými alebo tabuizovanými témami.";
                    break;
                case 'farce':
                    promptText = "Napíš krátku frašku s prehnanými situáciami, nedorozumeniami a rýchlym tempom.";
                    break;
                case 'slapstick':
                    promptText = "Napíš krátku slapstick komédiu plnú fyzického humoru a groteskných situácií.";
                    break;
                case 'action-comedy':
                    promptText = "Napíš krátku akčnú komédiu s vtipnými dialógmi a dynamickými akčnými scénami.";
                    break;
                case 'buddy-comedy':
                    promptText = "Napíš krátku buddy komédiu o dvoch nesúrodých postavách, ktoré sa spoja a zažijú vtipné dobrodružstvá.";
                    break;
                case 'coming-of-age-comedy':
                    promptText = "Napíš krátku komédiu o dospievaní, ktorá humorným spôsobom zobrazuje výzvy a trápne momenty mladosti.";
                    break;
                case 'mockumentary':
                    promptText = "Napíš krátky príbeh vo forme mockumentary, ktorý satirizuje dokumentárne filmy a reálne udalosti.";
                    break;
                case 'true-crime':
                    promptText = "Napíš krátky fikčný príbeh inšpirovaný skutočným zločinom, zameraný na vyšetrovanie a odhalenie páchateľa.";
                    break;
                case 'procedural':
                    promptText = "Napíš krátky procedurálny príbeh, ktorý detailne opisuje kroky vyšetrovania zločinu alebo riešenia problému.";
                    break;
                case 'hard-boiled':
                    promptText = "Napíš krátku hard-boiled detektívku s drsným detektívom, temnou atmosférou a morálne nejednoznačnými postavami.";
                    break;
                case 'cozy-mystery':
                    promptText = "Napíš krátku útulnú záhadu, kde sa zločin odohráva v malom, idylickom prostredí a vyšetruje ho amatérsky detektív.";
                    break;
                case 'espionage':
                    promptText = "Napíš krátky špionážny príbeh s tajnými agentmi, dvojitými hrami a medzinárodnými intrigami.";
                    break;
                case 'conspiracy-thriller':
                    promptText = "Napíš krátky konšpiračný thriller, kde hlavná postava odhalí rozsiahle sprisahanie a je v smrteľnom nebezpečenstve.";
                    break;
                case 'techno-thriller':
                    promptText = "Napíš krátky techno-thriller, ktorý sa zameriava na pokročilé technológie a ich potenciálne nebezpečenstvo.";
                    break;
                case 'eco-thriller':
                    promptText = "Napíš krátky eko-thriller, ktorý sa zaoberá ekologickými katastrofami a bojom za záchranu životného prostredia.";
                    break;
                case 'disaster':
                    promptText = "Napíš krátky katastrofický príbeh o skupine ľudí, ktorí sa snažia prežiť prírodnú alebo umelú katastrofu.";
                    break;
                case 'prison-break':
                    promptText = "Napíš krátky príbeh o úteku z väzenia, kde sa väzeň snaží prekabátiť stráže a získať slobodu.";
                    break;
                case 'revenge':
                    promptText = "Napíš krátky príbeh o pomste, kde sa hlavná postava snaží pomstiť za krivdu, ktorá jej bola spôsobená.";
                    break;
                case 'quest':
                    promptText = "Napíš krátky príbeh o výprave, kde hrdina musí prekonať prekážky a splniť dôležitú úlohu.";
                    break;
                case 'bildungsroman-fantasy':
                    promptText = "Napíš fantasy príbeh o dospievaní, kde mladý hrdina objavuje svoje magické schopnosti a svoje miesto vo svete.";
                    break;
                case 'bildungsroman-sci-fi':
                    promptText = "Napíš sci-fi príbeh o dospievaní, kde mladý hrdina objavuje svoje miesto v technologicky vyspelom svete alebo vo vesmíre.";
                    break;
                default:
                    promptText = "Napíš krátky a zaujímavý príbeh.";
                    break;
            }

            generateStoryBtn.disabled = true;

            try {
                let chatHistory = [];
                chatHistory.push({ role: "user", parts: [{ text: promptText }] });

                const payload = { contents: chatHistory };
                const apiKey = "AIzaSyD0OIR4P5gjUBvVJfWUSYZmQGck_aKoVv8";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                const result = await response.json();

                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const generatedText = result.candidates[0].content.parts[0].text;
                    currentStory = generatedText;
                    storyContentDiv.textContent = generatedText;
                    showElement(storyContentDiv);

                } else {
                    // Ak AI nevrátila platný obsah, jednoducho skryjeme storyContentDiv
                    // a zobrazíme počiatočnú správu, aby používateľ vedel, čo má robiť.
                    hideElement(storyContentDiv);
                    showElement(initialMessage);
                    console.error('Gemini API nevrátilo platný obsah príbehu.');
                }
            } catch (error) {
                console.error('Chyba pri generovaní príbehu:', error);
                storyContentDiv.textContent = 'Nastala chyba pri generovaní príbehu. Skúste to, prosím, znova.';
                showElement(storyContentDiv);
            } finally {
                hideElement(loadingStoryMessage);
                generateStoryBtn.disabled = false;
                checkGenerationLimit(); // Still call to ensure button state is correct
            }
        }

        // Funkcia na čítanie príbehu pomocou Web Speech API
        function readStory() {
            if (!currentStory) {
                return;
            }

            if (currentUtterance && window.speechSynthesis.speaking) {
                window.speechSynthesis.cancel();
            }

            hideElement(speechErrorMessage);
            showElement(connectingAIMessage);

            setTimeout(() => {
                const synth = window.speechSynthesis;
                const utterance = new SpeechSynthesisUtterance(currentStory);
                utterance.lang = 'sk-SK';
                utterance.rate = 1;
                utterance.pitch = 1;

                currentUtterance = utterance;

                utterance.onend = () => {
                    hideElement(connectingAIMessage);
                    hideElement(speechErrorMessage);
                };

                utterance.onerror = (event) => {
                    console.error('Chyba pri čítaní príbehu:', event.error || event);
                    speechErrorMessage.textContent = `Chyba pri čítaní: ${event.error ? `(${event.error})` : 'Neznáma chyba.'}`;
                    showElement(speechErrorMessage);
                    hideElement(connectingAIMessage);
                };

                synth.speak(utterance);
            }, 500);
        }

        // Event Listeners
        generateStoryBtn.addEventListener('click', generateStory);
        storyContentDiv.addEventListener('click', readStory);

        // Pri načítaní stránky skontrolujeme limit
        window.onload = checkGenerationLimit;
    </script>
</body>
</html>


